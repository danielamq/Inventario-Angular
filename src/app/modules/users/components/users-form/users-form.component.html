<div class="sales-form-container">

  <!-- CONTENIDO SCROLLEABLE -->
  <div class="scroll-content" style="max-height: 70vh; overflow-y: auto; padding-right: 10px;">

    <!-- TÍTULO -->
    <h2>{{ sAccionModal }} Distribuidor</h2>

    <!-- NOMBRE DEL DISTRIBUIDOR -->
    <div class="row mb-3">
      <div class="col-md-12">
        <mat-form-field appearance="outline" class="w-100">
          <mat-label>Nombre del distribuidor</mat-label>
          <input matInput [(ngModel)]="nuevoDistribuidor.nombre" name="nombre" />
        </mat-form-field>
      </div>
    </div>

    <!-- SECCIÓN PARA AGREGAR PRODUCTOS -->
    <div class="card p-3 mb-3 shadow-sm">
      <h4 class="mb-3">Agregar productos consignados</h4>

      <div class="row">

        <!-- Producto -->
        <div class="col-md-5">
          <mat-form-field appearance="outline" class="w-100">
            <mat-label>Producto</mat-label>
            <mat-select [(ngModel)]="productoSeleccionadoId" name="productoId">
              <mat-option *ngFor="let p of productos" [value]="p.id">
                {{ p.nombre }}
              </mat-option>
            </mat-select>
          </mat-form-field>
        </div>

        <!-- Cantidad -->
        <div class="col-md-3">
          <mat-form-field appearance="outline" class="w-100">
            <mat-label>Cantidad consignada</mat-label>
            <input matInput type="number" [(ngModel)]="cantidadConsignada" name="cantidad" />
          </mat-form-field>
        </div>

        <!-- Botón agregar -->
        <div class="col-md-3 d-flex align-items-center">
          <button mat-raised-button color="primary" class="w-100" (click)="agregarProducto()">
            Agregar producto
          </button>
        </div>

      </div>
    </div>

    <!-- LISTA DE PRODUCTOS CONSIGNADOS -->
    <div class="card p-3 shadow-sm" *ngIf="nuevoDistribuidor.productos.length > 0">
      <h4 class="mb-3">Productos del distribuidor</h4>

      <table class="table table-striped">
        <thead>
          <tr>
            <th>Producto</th>
            <th>Cantidad</th>
            <th></th>
          </tr>
        </thead>
        <tbody>
          <tr *ngFor="let item of nuevoDistribuidor.productos; let i = index">
            <td>{{ getNombreProducto(item.productoId) }}</td>
            <td>{{ item.cantidadConsignada }}</td>
            <td>
            <input type="number" class="form-control" [(ngModel)]="item.cantidadConsignada" min="0">
            </td>
            <td class="text-end">
              <button mat-icon-button color="warn" (click)="eliminarProducto(i)">
                <mat-icon>delete</mat-icon>
              </button>
            </td>
          </tr>
        </tbody>
      </table>
    </div>

  </div>

  <!-- BOTONES FIJOS -->
  <div class="footer-buttons">
    <button mat-button (click)="fnCerrarModal(0)">Cancelar</button>
    <button mat-raised-button color="accent" (click)="guardarDistribuidor()">Guardar</button>
  </div>

</div>
