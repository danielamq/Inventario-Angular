"use strict";(self.webpackChunkinventory=self.webpackChunkinventory||[]).push([[184],{9184:(ot,T,n)=>{n.r(T),n.d(T,{UsersModule:()=>tt});var p=n(9808),f=n(1083),l=n(3075),h=n(7423),A=n(4449),_=n(2181),Z=n(4107),N=n(2638),D=n(5245),C=n(7531),b=n(6087),F=n(4594),g=n(5861),S=n(5226),d=n.n(S),c=n(4999),w=n(4847),m=n(8966);class J{}var v=n(508),x=n(5581),t=n(5e3),M=n(3364),L=n(3084),u=n(7322);function E(e,i){if(1&e&&(t.TgZ(0,"mat-option",12),t._uU(1),t.qZA()),2&e){const o=i.$implicit;t.Q6J("value",o.id),t.xp6(1),t.hij(" ",o.nombre," ")}}let O=(()=>{class e{constructor(o,r,s,a){this.dialogRef=o,this.data=r,this.usersService=s,this.inventoryService=a,this.nuevoDistribuidor=new J,this.productos=[],this.sAccionModal="",this.sAccionModal=0==this.data.accion?"Agregar":"Editar",console.log(this.sAccionModal)}ngOnInit(){this.cargarProductos(),1===this.data.accion&&this.usersService.obtenerDistribuidorPorId(this.data.nIdDistribuidor).subscribe({next:o=>{this.nuevoDistribuidor=o,o.producto&&o.producto.id&&(this.nuevoDistribuidor.productoId=o.producto.id)},error:o=>{console.error("\u274c Error al cargar distribuidor:",o),d().fire("Error","No se pudieron cargar los datos del distribuidor","error")}})}cargarProductos(){this.inventoryService.listarProductos().subscribe({next:o=>{this.productos=o,console.log("\u2705 Productos cargados:",this.productos)},error:o=>console.error("\u274c Error cargando productos:",o)})}guardarDistribuidor(){var o=this;return(0,g.Z)(function*(){o.nuevoDistribuidor.nombre&&o.nuevoDistribuidor.productoId?0===o.data.accion?o.usersService.crearDistribuidor(o.nuevoDistribuidor).subscribe({next:()=>{d().fire({title:"Distribuidor creado con \xe9xito",text:"El distribuidor se ha registrado correctamente.",icon:"success",timer:2500,showConfirmButton:!1}),o.fnCerrarModal(1)},error:r=>{console.error("\u274c Error al crear distribuidor:",r),d().fire("Error","No se pudo crear el distribuidor. Intenta nuevamente.","error"),console.log("datso enviados",o.nuevoDistribuidor)}}):1===o.data.accion&&o.usersService.actualizarDistribuidor(o.data.nIdDistribuidor,o.nuevoDistribuidor).subscribe({next:()=>{d().fire({title:"Distribuidor actualizado con \xe9xito",text:"El distribuidor se ha modificado correctamente.",icon:"success",timer:2500,showConfirmButton:!1}),o.fnCerrarModal(1)},error:r=>{console.error("\u274c Error al actualizar distribuidor:",r),d().fire("Error","No se pudo actualizar el distribuidor. Intenta nuevamente.","error")}}):d().fire("Error","Debes completar nombre y seleccionar un producto","warning")})()}fnCerrarModal(o){1===o?this.dialogRef.close(o):this.dialogRef.close()}}return e.\u0275fac=function(o){return new(o||e)(t.Y36(m.so),t.Y36(m.WI),t.Y36(M.f),t.Y36(L.V))},e.\u0275cmp=t.Xpm({type:e,selectors:[["app-users-form"]],features:[t._Bn([{provide:v._A,useClass:x.B},{provide:v.sG,useValue:x.F}])],decls:27,vars:5,consts:[["mat-dialog-title","",1,"clstitulo"],["autocomplete","off","name","Formulario","id","new-form"],[1,"col-md-12"],[2,"display","initial"],["matInput","","type","text","maxlength","50","autocomplete","nope","name","nombre",3,"ngModel","ngModelChange"],["name","productoId",3,"ngModel","ngModelChange"],[3,"value",4,"ngFor","ngForOf"],["matInput","","type","number","autocomplete","nope","name","cantidadConsignada",3,"ngModel","ngModelChange"],[1,"row",2,"padding-top","1rem"],[1,"col-md-6"],["type","button","color","primary","mat-raised-button","",2,"width","100%",3,"click"],["type","button","color","warn","mat-raised-button","",2,"width","100%",3,"click"],[3,"value"]],template:function(o,r){1&o&&(t.TgZ(0,"div")(1,"h1",0),t._uU(2),t.qZA(),t.TgZ(3,"form",1)(4,"div",2)(5,"mat-form-field",3)(6,"mat-label"),t._uU(7,"Nombre Distribuidor"),t.qZA(),t.TgZ(8,"input",4),t.NdJ("ngModelChange",function(a){return r.nuevoDistribuidor.nombre=a}),t.qZA()()(),t.TgZ(9,"div",2)(10,"mat-form-field",3)(11,"mat-label"),t._uU(12,"Producto"),t.qZA(),t.TgZ(13,"mat-select",5),t.NdJ("ngModelChange",function(a){return r.nuevoDistribuidor.productoId=a}),t.YNc(14,E,2,2,"mat-option",6),t.qZA()()(),t.TgZ(15,"div",2)(16,"mat-form-field",3)(17,"mat-label"),t._uU(18,"Cantidad a consignar"),t.qZA(),t.TgZ(19,"input",7),t.NdJ("ngModelChange",function(a){return r.nuevoDistribuidor.cantidadConsignada=a}),t.qZA()()(),t.TgZ(20,"div",8)(21,"div",9)(22,"button",10),t.NdJ("click",function(){return r.guardarDistribuidor()}),t._uU(23,"Grabar"),t.qZA()(),t.TgZ(24,"div",9)(25,"button",11),t.NdJ("click",function(){return r.fnCerrarModal(0)}),t._uU(26,"Cancelar"),t.qZA()()()()()),2&o&&(t.xp6(2),t.hij("",r.sAccionModal," Distribuidor"),t.xp6(6),t.Q6J("ngModel",r.nuevoDistribuidor.nombre),t.xp6(5),t.Q6J("ngModel",r.nuevoDistribuidor.productoId),t.xp6(1),t.Q6J("ngForOf",r.productos),t.xp6(5),t.Q6J("ngModel",r.nuevoDistribuidor.cantidadConsignada))},directives:[m.uh,l._Y,l.JL,l.F,u.KE,u.hX,C.Nt,l.Fj,l.nD,l.JJ,l.On,Z.gD,p.sg,v.ey,l.wV,h.lW],styles:[".clstitulo[_ngcontent-%COMP%]{background-color:#334d6e;color:#fff;text-align:center;border-radius:calc(.25rem - 1px) calc(.25rem - 1px) 0 0;height:3rem;padding-top:.5rem}@media (min-width: 700px){.selectResp[_ngcontent-%COMP%]{bottom:.75rem}.pb-1[_ngcontent-%COMP%]{padding-bottom:1rem!important}}.selectMat[_ngcontent-%COMP%]{display:initial}"]}),e})();var y=n(7238);function P(e,i){if(1&e){const o=t.EpF();t.TgZ(0,"button",26),t.NdJ("click",function(){return t.CHM(o),t.oxw().fnClearFilter()}),t.TgZ(1,"mat-icon"),t._uU(2,"close"),t.qZA()()}}function B(e,i){1&e&&(t.TgZ(0,"th",27),t._uU(1,"Nombre"),t.qZA())}function I(e,i){if(1&e&&(t.TgZ(0,"td",28),t._uU(1),t.qZA()),2&e){const o=i.$implicit;t.xp6(1),t.Oqu(o.nombre)}}function Y(e,i){1&e&&(t.TgZ(0,"th",27),t._uU(1,"Producto consignado"),t.qZA())}function Q(e,i){if(1&e&&(t.TgZ(0,"td",28),t._uU(1),t.qZA()),2&e){const o=i.$implicit;t.xp6(1),t.Oqu(null==o.producto?null:o.producto.nombre)}}function R(e,i){1&e&&(t.TgZ(0,"th",27),t._uU(1,"Cantidad Consignaci\xf3n"),t.qZA())}function z(e,i){if(1&e&&(t.TgZ(0,"td",28),t._uU(1),t.qZA()),2&e){const o=i.$implicit;t.xp6(1),t.Oqu(o.cantidadConsignada)}}function H(e,i){1&e&&(t.TgZ(0,"th",27),t._uU(1,"Precio"),t.qZA())}function G(e,i){if(1&e&&(t.TgZ(0,"td",28),t._uU(1),t.ALo(2,"currency"),t.qZA()),2&e){const o=i.$implicit;t.xp6(1),t.Oqu(t.Dn7(2,1,null==o.producto?null:o.producto.precioMayorista,"COP","symbol"))}}function k(e,i){1&e&&(t.TgZ(0,"th",29),t._uU(1,"Acciones"),t.qZA())}function q(e,i){if(1&e){const o=t.EpF();t.TgZ(0,"td",28)(1,"button",30),t.NdJ("click",function(){const a=t.CHM(o).$implicit;return t.oxw().fnFormModal(1,a.id)}),t.TgZ(2,"mat-icon"),t._uU(3,"edit"),t.qZA()(),t.TgZ(4,"button",31),t.NdJ("click",function(){const a=t.CHM(o).$implicit;return t.oxw().fnEliminarDistribuidor(a.id)}),t.TgZ(5,"mat-icon"),t._uU(6,"delete"),t.qZA()()()}}function j(e,i){1&e&&t._UZ(0,"tr",32)}function X(e,i){1&e&&t._UZ(0,"tr",33)}const $=function(){return[10,25,100]},V=[{path:"",component:(()=>{class e{constructor(){}}return e.\u0275fac=function(o){return new(o||e)},e.\u0275cmp=t.Xpm({type:e,selectors:[["app-users"]],decls:1,vars:0,template:function(o,r){1&o&&t._UZ(0,"router-outlet")},directives:[f.lC],encapsulation:2}),e})(),children:[{path:"",redirectTo:"list",pathMatch:"full"},{path:"list",component:(()=>{class e{constructor(o,r){this.usersService=o,this.dialog=r,this.appName="Gesti\xf3n de Distribuidores",this.txtFiltro=new l.NI(""),this.displayedColumns=["nombre","producto","cantidadConsignada","precioMayorista","acciones"],this.dataSource=new c.by,this.dataSource=new c.by,this.dataSource.paginator=this.paginator,this.dataSource.sort=this.sort}ngOnInit(){this.listarDistribuidores()}fnClearFilter(){var o=this;return(0,g.Z)(function*(){o.dataSource&&(o.dataSource.filter="")})()}applyFilter(o){this.dataSource.filter=o.target.value.trim().toLowerCase(),this.dataSource.paginator&&this.dataSource.paginator.firstPage()}listarDistribuidores(){this.usersService.listarDistribuidores().subscribe({next:o=>{this.dataSource.data=o,this.dataSource.paginator=this.paginator,this.dataSource.sort=this.sort,console.log("distribuidores",this.dataSource.data)},error:o=>{console.error("\u274c Error al listar Distribuidores",o),d().fire("Error","No se pudieron cargar los Distribuidores","error")}})}fnFormModal(o,r){var s=this;return(0,g.Z)(function*(){s.accionActual=o,s.dialog.open(O,{width:"50rem",disableClose:!0,data:{accion:o,nIdDistribuidor:r}}).afterClosed().subscribe(U=>{void 0!==U&&s.listarDistribuidores()})})()}fnEliminarDistribuidor(o){var r=this;return(0,g.Z)(function*(){!(yield d().fire({title:"\xbfEst\xe1 seguro?",text:"Esta acci\xf3n eliminar\xe1 el distribuidor de forma permanente.",icon:"warning",showCancelButton:!0,confirmButtonColor:"#3085d6",cancelButtonColor:"#d33",confirmButtonText:"S\xed, eliminar",cancelButtonText:"Cancelar"})).isConfirmed||r.usersService.eliminarDistribuidor(o).subscribe({next:()=>{d().fire({title:"Distribuidor eliminado",text:"El distribuidor ha sido eliminado correctamente.",icon:"success",timer:2500,showConfirmButton:!1}),r.listarDistribuidores()},error:a=>{console.error("\u274c Error al eliminar Distribuidor:",a),d().fire({title:"Error",text:"No se pudo eliminar el distribuodor. Intenta nuevamente.",icon:"error",confirmButtonText:"Aceptar"})}})})()}}return e.\u0275fac=function(o){return new(o||e)(t.Y36(M.f),t.Y36(m.uw))},e.\u0275cmp=t.Xpm({type:e,selectors:[["app-users-list"]],viewQuery:function(o,r){if(1&o&&(t.Gf(b.NW,5),t.Gf(w.YE,5)),2&o){let s;t.iGM(s=t.CRH())&&(r.paginator=s.first),t.iGM(s=t.CRH())&&(r.sort=s.first)}},decls:37,vars:8,consts:[[1,"nav-container-general"],[1,"header-app"],[2,"font-weight","bold"],[1,"fab-container"],["matTooltipPosition","left","mat-raised-button","","mat-mini-fab","","color","primary","matTooltip","Agregar Distribuidor",1,"fab-secondary",3,"click"],[1,"material-icons"],[1,"form","row"],[1,"col-md-10"],["appearance","standard",2,"width","80%"],["matInput","",3,"formControl","keyup"],["input",""],["style","outline: none;","mat-button","","matSuffix","","mat-icon-button","","aria-label","Clear",3,"click",4,"ngIf"],["id","listaMobile",1,"mat-elevation-z8"],[1,"example-container"],["mat-table","","matSort","","aria-describedby","TablaProducto",2,"width","100%",3,"dataSource"],["matColumnDef","nombre"],["mat-header-cell","","mat-sort-header","",4,"matHeaderCellDef"],["mat-cell","",4,"matCellDef"],["matColumnDef","producto"],["matColumnDef","cantidadConsignada"],["matColumnDef","precioMayorista"],["matColumnDef","acciones"],["mat-header-cell","",4,"matHeaderCellDef"],["mat-header-row","",4,"matHeaderRowDef"],["mat-row","",4,"matRowDef","matRowDefColumns"],[3,"pageSizeOptions"],["mat-button","","matSuffix","","mat-icon-button","","aria-label","Clear",2,"outline","none",3,"click"],["mat-header-cell","","mat-sort-header",""],["mat-cell",""],["mat-header-cell",""],["mat-icon-button","","color","primary","matTooltip","Editar Distribuidor",3,"click"],["color","warn","mat-icon-button","","matTooltip","Eliminar Distribuidor",3,"click"],["mat-header-row",""],["mat-row",""]],template:function(o,r){1&o&&(t.TgZ(0,"div",0)(1,"div",1)(2,"h1",2),t._uU(3),t.qZA()(),t.TgZ(4,"div",3)(5,"button",4),t.NdJ("click",function(){return r.fnFormModal(0,0)}),t.TgZ(6,"span",5),t._uU(7,"add"),t.qZA()()(),t.TgZ(8,"div",6)(9,"div",7)(10,"mat-form-field",8)(11,"mat-label"),t._uU(12,"Buscar Distribuidor"),t.qZA(),t.TgZ(13,"input",9,10),t.NdJ("keyup",function(a){return r.applyFilter(a)}),t.qZA(),t.YNc(15,P,3,0,"button",11),t.qZA()()(),t.TgZ(16,"div",12)(17,"div",13)(18,"table",14),t.ynx(19,15),t.YNc(20,B,2,0,"th",16),t.YNc(21,I,2,1,"td",17),t.BQk(),t.ynx(22,18),t.YNc(23,Y,2,0,"th",16),t.YNc(24,Q,2,1,"td",17),t.BQk(),t.ynx(25,19),t.YNc(26,R,2,0,"th",16),t.YNc(27,z,2,1,"td",17),t.BQk(),t.ynx(28,20),t.YNc(29,H,2,0,"th",16),t.YNc(30,G,3,5,"td",17),t.BQk(),t.ynx(31,21),t.YNc(32,k,2,0,"th",22),t.YNc(33,q,7,0,"td",17),t.BQk(),t.YNc(34,j,1,0,"tr",23),t.YNc(35,X,1,0,"tr",24),t.qZA(),t._UZ(36,"mat-paginator",25),t.qZA()()()),2&o&&(t.xp6(3),t.Oqu(r.appName),t.xp6(10),t.Q6J("formControl",r.txtFiltro),t.xp6(2),t.Q6J("ngIf",r.txtFiltro.value),t.xp6(3),t.Q6J("dataSource",r.dataSource),t.xp6(16),t.Q6J("matHeaderRowDef",r.displayedColumns),t.xp6(1),t.Q6J("matRowDefColumns",r.displayedColumns),t.xp6(1),t.Q6J("pageSizeOptions",t.DdM(7,$)))},directives:[h.lW,y.gM,u.KE,u.hX,C.Nt,l.Fj,l.JJ,l.oH,p.O5,u.R9,D.Hw,c.BZ,c.w1,c.fO,c.ge,c.Dz,c.ev,c.as,c.XQ,c.nj,c.Gk,b.NW],pipes:[p.H9],styles:["table[_ngcontent-%COMP%]{width:100%}.header-app[_ngcontent-%COMP%]{text-align:center;margin-top:1rem}h1[_ngcontent-%COMP%]{margin-bottom:0}.example-container[_ngcontent-%COMP%]{width:100%;overflow:auto}.clsColumnaNombre[_ngcontent-%COMP%]{width:20%}.clsColumnaDescripcion[_ngcontent-%COMP%]{width:35%}.clsColumnaStock[_ngcontent-%COMP%]{width:15%}.clsColumnaAccion[_ngcontent-%COMP%]{width:20%}"]}),e})(),data:{route:"users/list"}}]}];let W=(()=>{class e{}return e.\u0275fac=function(o){return new(o||e)},e.\u0275mod=t.oAB({type:e}),e.\u0275inj=t.cJS({imports:[[f.Bz.forChild(V)],f.Bz]}),e})();var K=n(6856);let tt=(()=>{class e{}return e.\u0275fac=function(o){return new(o||e)},e.\u0275mod=t.oAB({type:e}),e.\u0275inj=t.cJS({imports:[[p.ez,W,A.ie,_.Tx,Z.LD,N.SJ,l.u5,l.UX,D.Ps,C.c,b.TU,F.g0,h.ot,u.lN,c.p0,m.Is,K.FA,y.AV],f.Bz]}),e})()}}]);